<%- include('../partials/header') %>

<!-- Font Awesome para o ícone de olho -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<div class="auth-container">
  <h2 class="form-title">Alterar Palavra-passe</h2>
  <form method="POST" action="/users/change-password" autocomplete="off" class="login-form">

    <label for="email">
    <input id="email" name="email" type="email" placeholder="Seu email cadastrado" required />
    </label>
    <label for="newPassword">
    <div class="password-wrapper">
      <input id="newPassword" name="newPassword" type="password" placeholder="Nova palavra-passe" required />
      <i class="far fa-eye" id="toggleNewPassword" title="Mostrar/ocultar senha"></i>
    </div></label>

    <label for="confirmPassword">
    <div class="password-wrapper">
      <input id="confirmPassword" name="confirmPassword" type="password" placeholder="Confirme a nova palavra-passe" required />
      <i class="far fa-eye" id="toggleConfirmPassword" title="Mostrar/ocultar senha"></i>
    </div></label>

    <div class="form-actions-center">
      <button type="submit" class="blue-button">Alterar Palavra-passe</button>
      <a href="/" class="red-button" style="text-decoration:none; display:inline-block;">Cancelar</a>
    </div>
  </form>

  <% if (typeof error !== 'undefined' && error) { %>
    <div class="error-message"><%= error %></div>
  <% } %>
  <% if (typeof success !== 'undefined' && success) { %>
    <div class="success-message"><%= success %></div>
  <% } %>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Mostrar/ocultar nova senha
    const newPasswordField = document.getElementById('newPassword');
    const toggleNewPassword = document.getElementById('toggleNewPassword');
    toggleNewPassword.addEventListener('click', function() {
      const type = newPasswordField.getAttribute('type') === 'password' ? 'text' : 'password';
      newPasswordField.setAttribute('type', type);
      this.classList.toggle('fa-eye');
      this.classList.toggle('fa-eye-slash');
    });

    // Mostrar/ocultar confirmação de senha
    const confirmPasswordField = document.getElementById('confirmPassword');
    const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
    toggleConfirmPassword.addEventListener('click', function() {
      const type = confirmPasswordField.getAttribute('type') === 'password' ? 'text' : 'password';
      confirmPasswordField.setAttribute('type', type);
      this.classList.toggle('fa-eye');
      this.classList.toggle('fa-eye-slash');
    });
  });
</script>

<%- include('../partials/footer') %>
